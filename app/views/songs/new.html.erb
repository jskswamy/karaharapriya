<%= form_tag 'create' , :remote => true do %>
  <div class="left">

    <div class="header">
      Song
    </div>

    <div class="body">
      <div class="section">
        <div class="title">
          <%= label_tag "song_song_type_id", "Song Type" %>
        </div>
        <div class="input">
          <%= select_tag "song[song_type_id]" , options_for_select(@song_types.collect{ |type| [type.name, type.id] }), :include_blank => "-select-" %>
        </div>
      </div>

      <div class="section">
        <div class="title">
          <%= label_tag "song_name", "Name" %>
        </div>
        <div class="input">
          <%= text_field_tag "song[name]" %>
        </div>
      </div>

      <div class="section">
        <div class="title">
          <%= label_tag "song_composer_name", "Composer" %>
        </div>
        <div class="input">
          <%= hidden_field_tag "song[composer_id]" %>
          <%= text_field_tag "composer_name" %>
          <div id="composer_name_completion" class="auto_completion"></div>
        </div>
      </div>

      <div class="section">
        <div class="title">
          <%= label_tag "song_ragam_id", "Ragam" %>
        </div>
        <div class="input">
          <%= hidden_field_tag "song[ragam_id]" %>
          <%= text_field_tag "ragam_name" %>
          <div id="ragam_completion" class="auto_completion"></div>
        </div>
      </div>

      <div class="section">
        <div class="title">
          <%= label_tag "song_talam_id", "Talam" %>
        </div>
        <div class="input">
          <%= hidden_field_tag "song[talam_id]" %>
          <%= text_field_tag "talam_name" %>
          <div id="talam_completion" class="auto_completion"></div>
        </div>
      </div>

      <div class="section">
        <div class="title">
          <%= label_tag "song_description", "Description" %>
        </div>
        <div class="input">
          <%= text_area_tag "song[description]" %>
        </div>
      </div>
    </div>
  </div>

  <div class="right">
    <div id="flash_notice" style="color:red;">
      <%= flash[:notice] %>
    </div>

    <div id='content'>
      <%= render :partial => "create_instruction" %>
    </div>
  </div>

<% end %>

<script type="text/javascript">
  var editor = new Song.Editor($('content'), $('song_song_type_id'), <%= "'#{editor_songs_path}'" %> );
  var composerAutoComplete = new Ajax.Autocompleter('composer_name',
      'composer_name_completion', <%= "'#{suggest_composer_path}'" %>, {
          method: "get",
          paramName: "name",
          afterUpdateElement: function(text, li) {
            $('song_composer_id').value = li.id;
          }
      });
  var ragamAutoComplete = new Ajax.Autocompleter('ragam_name',
      'ragam_completion', <%= "'#{suggest_ragam_path}'" %>, {
          method: "get",
          paramName: "name",
          afterUpdateElement: function(text, li) {
            $('song_ragam_id').value = li.id;
          }
      });
  var talamAutoComplete = new Ajax.Autocompleter('talam_name',
      'talam_completion', <%= "'#{suggest_talam_path}'" %>, {
          method: "get",
          paramName: "name",
          afterUpdateElement: function(text, li) {
            $('song_talam_id').value = li.id;
          }
      });
</script>
